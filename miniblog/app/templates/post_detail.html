{% extends "base.html" %}
{% block title %}{{ post.titulo }}{% endblock %}

{% block content %}
<div class="post-card">
    <h1>{{ post.titulo }}</h1>
    <p class="post-meta">Publicado por {{ post.autor.username }} el {{ post.fecha.strftime('%d/%m/%Y') }}</p>
    <p>{{ post.contenido }}</p>

    {% if current_user.id == post.autor.id %}
        <a class="btn-warning btn" href="{{ url_for('edit_post', post_id=post.id) }}">Editar</a>
        <a class="btn-danger btn" href="{{ url_for('delete_post', post_id=post.id) }}">Eliminar</a>
    {% endif %}
</div>

<h2>Comentarios</h2>
{% for comentario in post.comentarios %}
<div class="post-card">
    <p><strong>{{ comentario.autor.username }}:</strong> {{ comentario.contenido }}</p>
</div>
{% else %}
<p>No hay comentarios.</p>
{% endfor %}

{% if current_user.is_authenticated %}
<form method="POST" action="{{ url_for('add_comment', post_id=post.id) }}">
    {{ form.hidden_tag() }}
    <div class="form-group">
        {{ form.contenido.label }}
        {{ form.contenido() }}
    </div>
    <button type="submit" class="btn">Comentar</button>
</form>
{% else %}
<p>Debes <a href="{{ url_for('login') }}">iniciar sesi√≥n</a> para comentar.</p>
{% endif %}
{% endblock %}
